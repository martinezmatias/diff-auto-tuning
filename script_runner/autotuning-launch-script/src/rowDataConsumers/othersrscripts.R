### others
limitd = 0000
limitup = 14000#14000
v1 = as.numeric(readLines("/Users/matias/develop/gt-tuning/git-code-gpgt/script_runner/autotuning-launch-script/plots/data/paired_values_size_1.csv"))[limitd:limitup]
v2 = as.numeric(readLines("/Users/matias/develop/gt-tuning/git-code-gpgt/script_runner/autotuning-launch-script/plots/data/paired_values_size_2.csv"))[limitd:limitup]

install.packages('magrittr')
install.packages('tidyverse')
install.packages('rstatix')
install.packages('ggpubr')
install.packages('datarium')
library(tidyverse)
library(rstatix)
library(ggpubr)


library(rcompanion)
library(lattice)
library(FSA)
# data.frame(dat17, dat16, check.rows= FALSE)
wilcox.test(v1,v2, paired = TRUE)
m = data.frame(v1, v2)
wilcoxonR(x=m$v1, g=m$v2)


#vda(v1 ~ v2, data=m, ci=TRUE)

library(effsize)
cliff.delta(d = v1, f =  v2)


v1 = as.numeric(readLines("/Users/matias/develop/gt-tuning/git-code-gpgt/script_runner/autotuning-launch-script/plots/data/paired_values_heigth_1.csv"))#[limitd:limitup]
v2 = as.numeric(readLines("/Users/matias/develop/gt-tuning/git-code-gpgt/script_runner/autotuning-launch-script/plots/data/paired_values_heigth_2.csv"))#[limitd:limitup]
wilcox.test(v1,v2, paired = TRUE)
m = data.frame(v1, v2)
wilcoxonR(x=m$v1, g=m$v2)

library(magrittr)
library(tidyverse)
library(rstatix)
library(ggpubr)
stat.test <- m %>% 
  wilcox_test(weight ~ group) %>%
  add_significance()
stat.test

## based on https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/#:~:text=Calculate%20and%20report%20Wilcoxon%20test%20effect%20size%20(r%20value).&text=The%20r%20value%20varies%20from,%3D%200.5%20(large%20effect).
# Load the data

data("genderweight", package = "datarium")
# Show a sample of the data by group
set.seed(123)
genderweight %>% sample_n_by(group, size = 2)

bxp <- ggboxplot(
  genderweight, x = "group", y = "weight", 
  ylab = "Weight", xlab = "Groups", add = "jitter"
)
bxp

stat.test <- genderweight %>% 
  wilcox_test(weight ~ group) %>%
  add_significance()
stat.test
genderweight %>% wilcox_effsize(weight ~ group)

#### Now addapting 

bxp <- ggboxplot(
  m, x = "v1", y = "v2", 
  ylab = "Weight", xlab = "Groups", add = "jitter"
)
bxp

stat.test <- m %>% 
  wilcox_test(v1 ~ v2) %>%
  add_significance()
stat.test
m %>% wilcox_effsize(v1 ~ v2)

###Index
t1 =  c(243, 359, 363, 367, 370, 70, 343, 347, 351, 353, 63, 328, 331, 335, 337, 59, 311, 315, 319, 323, 54, 295, 299, 303, 308, 50, 279, 283, 287, 293, 45, 263, 267, 271, 275, 39, 245, 250, 255, 259, 34, 227, 231, 235, 239, 28, 207, 215, 219, 223, 25, 187, 199, 203, 209, 22, 168, 183, 190, 195, 18, 151, 167, 175, 179, 12, 129, 154, 159, 163, 9, 116, 139, 143, 147, 7, 105, 126, 131, 135, 5, 92, 113, 119, 123, 3, 79, 101, 107, 110, 1, 72, 89, 95, 98, 0, 67, 76, 82, 86, 244, 360, 364, 368, 372, 71, 344, 348, 352, 356, 64, 327, 333, 336, 340, 60, 312, 316, 320, 324, 55, 296, 300, 304, 307, 51, 280, 284, 288, 291, 46, 264, 268, 272, 276, 40, 246, 251, 256, 261, 36, 228, 232, 236, 240, 31, 208, 216, 220, 224, 27, 188, 200, 204, 211, 24, 169, 184, 191, 196, 20, 152, 170, 176, 180, 16, 130, 155, 160, 164, 13, 117, 140, 144, 148, 11, 104, 127, 133, 137, 8, 93, 114, 121, 124, 6, 80, 102, 108, 111, 4, 73, 90, 96, 99, 2, 68, 77, 84, 87, 249, 361, 365, 369, 373, 75, 345, 349, 354, 357, 65, 329, 332, 338, 341, 61, 313, 317, 321, 325, 57, 297, 301, 305, 309, 53, 281, 285, 290, 292, 48, 265, 269, 274, 277, 44, 247, 252, 258, 260, 41, 229, 233, 238, 241, 37, 210, 217, 222, 225, 33, 189, 201, 206, 212, 29, 173, 185, 194, 197, 26, 153, 171, 178, 181, 23, 132, 157, 162, 165, 21, 118, 141, 146, 149, 19, 106, 128, 134, 138, 17, 94, 115, 122, 125, 15, 81, 103, 109, 112, 14, 74, 91, 97, 100, 10, 69, 78, 85, 88, 254, 362, 366, 371, 374, 83, 346, 350, 355, 358, 66, 330, 334, 339, 342, 62, 314, 318, 322, 326, 58, 298, 302, 306, 310, 56, 282, 286, 289, 294, 52, 266, 270, 273, 278, 49, 248, 253, 257, 262, 47, 230, 234, 237, 242, 43, 214, 218, 221, 226, 42, 192, 202, 205, 213, 38, 174, 186, 193, 198, 35, 156, 172, 177, 182, 32, 136, 158, 161, 166, 30, 120, 142, 145, 150)
t2 =  c(209, 359, 363, 367, 368, 67, 343, 347, 351, 355, 62, 327, 331, 335, 339, 56, 311, 315, 319, 323, 49, 295, 299, 303, 306, 39, 279, 283, 287, 291, 33, 257, 267, 271, 275, 28, 238, 251, 255, 261, 20, 217, 234, 240, 245, 17, 195, 216, 225, 229, 14, 175, 201, 207, 212, 11, 151, 182, 191, 197, 7, 130, 164, 177, 185, 6, 111, 147, 163, 170, 5, 92, 132, 148, 156, 4, 85, 120, 138, 144, 3, 80, 108, 127, 133, 2, 76, 96, 116, 122, 1, 73, 88, 104, 110, 0, 70, 83, 93, 100, 220, 360, 364, 369, 372, 68, 344, 348, 352, 356, 64, 328, 332, 336, 340, 59, 312, 316, 320, 325, 52, 296, 300, 304, 308, 46, 280, 284, 288, 292, 38, 260, 268, 272, 276, 35, 239, 252, 256, 262, 31, 219, 235, 241, 246, 26, 196, 218, 226, 230, 21, 176, 203, 208, 213, 19, 154, 184, 192, 198, 18, 131, 166, 178, 186, 16, 115, 149, 165, 171, 15, 97, 136, 150, 158, 13, 87, 121, 139, 145, 12, 81, 109, 128, 134, 10, 78, 98, 117, 123, 9, 74, 90, 105, 112, 8, 71, 84, 94, 101, 233, 361, 365, 371, 373, 69, 345, 349, 354, 358, 65, 329, 333, 338, 341, 61, 313, 317, 321, 324, 57, 297, 301, 305, 309, 53, 281, 285, 289, 293, 48, 265, 269, 273, 277, 44, 242, 253, 258, 263, 40, 222, 236, 243, 248, 37, 202, 221, 227, 232, 36, 179, 204, 210, 214, 34, 161, 189, 193, 199, 32, 137, 169, 180, 187, 30, 119, 155, 167, 172, 29, 99, 141, 152, 159, 27, 89, 126, 140, 146, 25, 82, 114, 129, 135, 24, 79, 102, 118, 125, 23, 75, 91, 106, 113, 22, 72, 86, 95, 103, 250, 362, 366, 370, 374, 77, 346, 350, 353, 357, 66, 330, 334, 337, 342, 63, 314, 318, 322, 326, 60, 298, 302, 307, 310, 58, 282, 286, 290, 294, 55, 266, 270, 274, 278, 54, 247, 254, 259, 264, 51, 224, 237, 244, 249, 50, 205, 223, 228, 231, 47, 183, 206, 211, 215, 45, 162, 190, 194, 200, 43, 142, 174, 181, 188, 42, 124, 157, 168, 173, 41, 107, 143, 153, 160)

wilcox.test(t1,t2, paired = TRUE)
tcd = data.frame(t1, t2)
wilcoxonR(x=tcd$t1, g=tcd$t2)

nA=length(t1)
nB=length(t2)
n=nA+nB
groupes=c(rep("A",nA),rep("B",nB))
x=c(t1,t2)
boxplot(x~groupes, col=c("pink","lightsteelblue3"))

## Performance

p1 =  c(0.010,0.009,0.008,0.007,0.007,0.028,0.024,0.020,0.017,0.017,0.043,0.036,0.029,0.024,0.024,0.117,0.086,0.059,0.047,0.047,0.674,0.398,0.217,0.171,0.170,0.009,0.008,0.007,0.006,0.006,0.024,0.022,0.019,0.016,0.015,0.039,0.034,0.028,0.023,0.023,0.101,0.082,0.057,0.045,0.044,0.576,0.386,0.210,0.165,0.163,0.008,0.007,0.006,0.005,0.005,0.020,0.019,0.017,0.013,0.014,0.032,0.030,0.024,0.020,0.020,0.076,0.067,0.048,0.038,0.037,0.327,0.285,0.177,0.139,0.138,0.005,0.004,0.004,0.003,0.003,0.012,0.012,0.010,0.008,0.008,0.018,0.017,0.014,0.012,0.011,0.038,0.036,0.029,0.023,0.022,0.140,0.134,0.103,0.083,0.082,0.002,0.002,0.002,0.002,0.006,0.006,0.005,0.005,0.005,0.007,0.007,0.006,0.006,0.006,0.010,0.010,0.010,0.009,0.009,0.021,0.021,0.020,0.019,0.019,0.010,0.009,0.007,0.004,0.004,0.027,0.023,0.019,0.012,0.011,0.044,0.036,0.027,0.017,0.016,0.118,0.086,0.055,0.034,0.031,0.673,0.406,0.197,0.116,0.102,0.010,0.008,0.007,0.004,0.004,0.026,0.023,0.018,0.011,0.011,0.041,0.035,0.026,0.016,0.015,0.110,0.083,0.053,0.032,0.029,0.578,0.389,0.191,0.112,0.098,0.010,0.008,0.006,0.003,0.022,0.021,0.017,0.010,0.010,0.036,0.032,0.024,0.015,0.014,0.092,0.075,0.049,0.029,0.026,0.432,0.338,0.179,0.104,0.090,0.007,0.006,0.005,0.003,0.003,0.017,0.016,0.014,0.008,0.008,0.027,0.025,0.019,0.012,0.010,0.062,0.056,0.039,0.023,0.020,0.255,0.234,0.143,0.084,0.072,0.003,0.003,0.003,0.002,0.002,0.007,0.007,0.006,0.005,0.005,0.009,0.008,0.008,0.006,0.006,0.013,0.012,0.012,0.010,0.009,0.024,0.024,0.022,0.020,0.019,0.011,0.009,0.006,0.004,0.003,0.027,0.023,0.018,0.010,0.009,0.044,0.036,0.026,0.015,0.012,0.119,0.086,0.053,0.030,0.025,0.674,0.401,0.192,0.106,0.078,0.010,0.008,0.006,0.004,0.003,0.026,0.023,0.017,0.010,0.008,0.042,0.035,0.026,0.015,0.012,0.112,0.084,0.052,0.029,0.024,0.601,0.391,0.188,0.104,0.076,0.010,0.008,0.006,0.003,0.003,0.024,0.021,0.017,0.010,0.008,0.038,0.033,0.025,0.014,0.011,0.099,0.078,0.049,0.027,0.021,0.491,0.359,0.180,0.098,0.071,0.009,0.007,0.006,0.003,0.003,0.020,0.018,0.015,0.008,0.007,0.031,0.028,0.021,0.012,0.009,0.074,0.064,0.042,0.023,0.018,0.322,0.278,0.154,0.085,0.060,0.004,0.004,0.003,0.002,0.002,0.009,0.009,0.008,0.005,0.005,0.011,0.011,0.009,0.007,0.006,0.016,0.015,0.014,0.011,0.010,0.028,0.027,0.024,0.021,0.020,0.002,0.004)
p2 =  c(0.011,0.010,0.008,0.007,0.007,0.028,0.024,0.019,0.016,0.016,0.043,0.034,0.027,0.022,0.022,0.116,0.087,0.061,0.049,0.049,0.675,0.399,0.212,0.165,0.163,0.010,0.008,0.007,0.006,0.006,0.024,0.021,0.017,0.014,0.014,0.038,0.032,0.025,0.021,0.021,0.099,0.081,0.056,0.046,0.045,0.584,0.384,0.204,0.158,0.156,0.009,0.008,0.006,0.005,0.005,0.020,0.019,0.015,0.012,0.013,0.031,0.028,0.022,0.018,0.018,0.076,0.067,0.050,0.040,0.039,0.331,0.283,0.173,0.135,0.133,0.005,0.004,0.004,0.003,0.003,0.012,0.012,0.010,0.008,0.008,0.018,0.017,0.015,0.012,0.012,0.040,0.038,0.031,0.026,0.025,0.144,0.137,0.104,0.083,0.081,0.003,0.002,0.002,0.002,0.005,0.005,0.005,0.004,0.004,0.007,0.007,0.007,0.006,0.006,0.012,0.011,0.011,0.011,0.011,0.024,0.024,0.024,0.023,0.023,0.012,0.009,0.006,0.004,0.004,0.027,0.023,0.017,0.011,0.010,0.043,0.034,0.025,0.017,0.015,0.117,0.085,0.056,0.036,0.032,0.674,0.405,0.193,0.115,0.099,0.011,0.009,0.006,0.004,0.004,0.025,0.022,0.016,0.010,0.010,0.040,0.033,0.024,0.015,0.014,0.108,0.082,0.053,0.034,0.031,0.580,0.387,0.188,0.111,0.096,0.011,0.008,0.006,0.004,0.023,0.020,0.015,0.010,0.009,0.036,0.030,0.022,0.014,0.013,0.093,0.074,0.050,0.032,0.028,0.430,0.335,0.174,0.103,0.088,0.008,0.007,0.005,0.003,0.003,0.018,0.016,0.013,0.008,0.007,0.027,0.024,0.019,0.012,0.011,0.063,0.057,0.040,0.026,0.023,0.257,0.235,0.139,0.084,0.070,0.004,0.003,0.003,0.002,0.002,0.007,0.006,0.006,0.005,0.004,0.009,0.009,0.008,0.006,0.006,0.015,0.014,0.013,0.011,0.011,0.029,0.028,0.026,0.024,0.023,0.012,0.009,0.006,0.003,0.003,0.027,0.022,0.016,0.009,0.008,0.043,0.034,0.024,0.015,0.012,0.118,0.085,0.054,0.032,0.025,0.675,0.400,0.188,0.105,0.078,0.011,0.009,0.006,0.003,0.003,0.025,0.022,0.015,0.009,0.008,0.041,0.033,0.023,0.014,0.012,0.111,0.082,0.053,0.031,0.024,0.603,0.389,0.184,0.103,0.075,0.011,0.008,0.006,0.003,0.003,0.024,0.021,0.015,0.009,0.007,0.038,0.031,0.022,0.013,0.011,0.100,0.077,0.050,0.029,0.022,0.487,0.355,0.175,0.097,0.070,0.010,0.008,0.006,0.003,0.003,0.021,0.019,0.014,0.008,0.006,0.032,0.027,0.020,0.012,0.010,0.077,0.066,0.045,0.026,0.019,0.321,0.275,0.152,0.084,0.060,0.005,0.004,0.004,0.002,0.002,0.009,0.009,0.007,0.005,0.004,0.012,0.011,0.010,0.007,0.006,0.019,0.018,0.016,0.012,0.011,0.033,0.031,0.028,0.025,0.023,0.002,0.004)
wilcox.test(p1,p2, paired = TRUE, alternative = "two.sided")
wilcox.test(p1,p2, paired = FALSE, alternative = "two.sided")
tcd = data.frame(p1, p2)
#wilcoxonR(x=tcd$p1, g=tcd$p2)

nA=length(p1)
nB=length(p2)
n=nA+nB
groupes=c(rep("A",nA),rep("B",nB))
x=c(p1,p2)
boxplot(x~groupes, col=c("pink","lightsteelblue3"))

